<%inherit file="base.html"/>
<%block name="title">ago control floorplan</%block>

<script type="text/javascript">
	var inventory = ${inventory};

	function set_dragable(elem) {
		elem.draggable({
				containment: "#plan #devices",
				stack: "#devices div",
				cursor: "move",
				snap: ".device",
				revert: true
			});
	}

	$(document).ready(function () {
		for (var i = 0; i < inventory.length; i++) {
			var elem = $('<div class="device" style="border: 1px dashed #000; float: left; width: 150px; height: 50px; margin: 5px;">' +
						  inventory[i].name + " (" + inventory[i].devicetype + ") </div>")
			elem.appendTo("#devices");
			set_dragable(elem);
		}

		$('<br style="clear:both" />').appendTo("#devices");

		$("#devices").droppable({
			accept: ".device",
			drop: function(event, ui) {
				 ui.draggable.css("position", "auto");
				 ui.draggable.css("left", "auto");
				 ui.draggable.css("top", "auto");

				 ui.draggable.draggable('option','revert', false);
				 ui.draggable.draggable('destroy');
				 set_dragable(ui.draggable);
			}
		});

		$("#plan").droppable({
			accept: ".device",
			drop: function(event, ui) {
				ui.draggable.draggable('option','revert', false);
				ui.draggable.draggable('destroy');
				set_dragable(ui.draggable);
			}
		});
	});
</script>

<div id="devices">
</div>
<br style="clear:both" />
<div id="plan" style="width:100%;border:1px solid; height: 800px;">
</div>