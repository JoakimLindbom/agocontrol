<%inherit file="base.html"/>
<%block name="title">ago control Event Editor</%block>
<h2>Edit Event</h2>
<h4>Criteria</h4>
<div id="eventBuilder"></div><br />
<h4>Action</h4>
<div id="actionBuilder"></div> <br />
<form action="" method="post">
<h4>Name</h4>
<div class="row">
  <div class="four columns">
    <dl class="field row">
     <dt class="text">
	<input type="text" id="event_name" name="event_name" value="${event_name}" />
     </dt>
    </dl>
  </div>
  <div class="one columns">
    <input class="btn" type="button" value="Save Event" onclick="create_json('${uuid}');" />
  </div>
</div>

<!--<textarea name="json_input" id="json_input"></textarea>
<input type="button" value="json_to_list" onclick="json_to_list(document.getElementById('json_input').value, document.getElementById('eventBuilder'))" />-->
<script type="text/javascript">
var current_id = 0;
var eventMap = ${eventMap};
var deviceTypes = ${deviceTypes};
var devices = ${devices};
var commands = ${commands};
</script>
<script src="static/js/agoevent.js"></script>
<script type="text/javascript">
var eventSelector = get_event_selector(eventMap, document.getElementById("eventBuilder"));
eventSelector.id = "eventSelector";
document.getElementById("eventBuilder").appendChild(eventSelector);
render_main_connector("and", document.getElementById("eventBuilder"));
add_nesting(document.getElementById("eventBuilder"), "and");
create_action_builder(document.getElementById("actionBuilder"), ${action});
json_to_list('${currentEvent}');
</script>
